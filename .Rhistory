set.seed(01012022)
x1=seq(0,1,0.01)
x2=seq(0,1,0.001)
x2=seq(0,1,0.09)
x2=seq(0,1,0.009)
x2=seq(0,1,0.005)
x2=seq(0,1,0.001)
x2=seq(0,1,0.002)
x2=seq(0,1,0.0025)
x2=seq(0,1,0.002)
x1=seq(0,1,0.002)
z=m(x1,x2)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.002)
x2=seq(0,1,0.002)
z=m(x1,x2)
persp(x1,x2,z)
z=m(x1,x2)
z
z=outer(x1,x2,z)
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.002)
x2=seq(0,1,0.002)
z=outer(x1,x2,m)
persp(x1,x2,z)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.002)
x1=seq(0,1,0.01)
x1=seq(0,1,0.009)
x1=seq(0,1,0.008)
500/3
x1=seq(0,1,0.005)
x1=seq(0,1,0.006)
x1=seq(0,1,0.006)
x2=seq(0,1,0.006)
z=outer(x1,x2,m)
persp(x1,x2,z)
x1=seq(0,1,0.01)
x2=seq(0,1,0.01)
z=outer(x1,x2,m)
persp(x1,x2,z)
sin(2*pi*x1)
a=sin(2*pi*x1)
plot(a)
persp(x1,x2,z,phi=30,col = "red",main="Función", ticktype = "detail")
persp(x1,x2,z,phi=30,col = "green",main="Función")
?persp
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
x1=seq(0,1,0.1)
x1=seq(0,1,0.09)
x1=seq(0,1,0.05)
x1=seq(0,1,0.04)
x1=seq(0,1,0.03)
x1=seq(0,1,0.02)
x2=seq(0,1,0.02)
x1=seq(0,1,0.02)
x2=seq(0,1,0.02)
z=outer(x1,x2,m)
error=rnorm(51,0,1/4)
y=m(x1,x2)+error
?loess
??sm.regression
mod1=loess(y~x1+x2,span=0.3,degree = 0)
mod1=loess(y~x1+x2,span=0.3,degree = 1)
mod1=loess(y~x1+x2,span=c(0.3,0.3),degree = 0)
mod1=loess(y~x1+x2,span=0.3,degree = 0)
mod1=loess(y~x1+x2,span=0.3,degree = 1)
z1=expand.grid(x1,x2)
z1
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.02)
x2=seq(0,1,0.02)
z=outer(x1,x2,m)
error=rnorm(51,0,1/4)
y=m(x1,x2)+error
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
mod1=loess(y~x1+x2,span=0.3,degree = 0)
mod1=loess(y~x1+x2,span=0.3,degree = 1)
z1=expand.grid(x1,x2)
View(z1)
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
predict(mod1,z1)
mod1=loess(y~x1+x2,span=0.3,degree = 0)
y=m(x1,x2)+error
mod1=loess(y~x1+x2,degree = 0)
mod1=loess(y~x1+x2,span=0.3,degree = 0)
z1=expand.grid(x1,x2)
mod1$fitted
z
51*51
z1=matrix(expand.grid(x1,x2),ncol = 51)
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
z1=matrix(expand.grid(x1,x2),ncol = 51,nrow = 51)
z1
expand.grid(x1,x2)
z1=arrange(expand.grid(x1,x2),ncol = 51,nrow = 51)
array?
?array
z1=array(expand.grid(x1,x2),c(51,51))
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
predict(mod1,z1)
persp(x1,x2,mod1$fitted,phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
predict(mod1)
?predict
z1=expand.grid(x1,x2)
predict(mod1,z1)
a=predict(mod1,z1)
View(a)
persp(x1,x2,a,phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
mod2=loess(y~x1+x2,span=0.3,degree = 1)
z2=expand.grid(x1,x2)
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
par(mfrow=c(3,1))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
install.packages("sm")
library(sm)
sm.regression(cbind(x1,x2),y,h=c(0.3,0.3),dispay="image")
mod1
sm.regression(cbind(x1,x2),y,h=c(0.3,0.3),dispay="image")
sm.regression(x1,y,h=c(0.3,0.3),dispay="image")
sm.regression(x1,y,h=c(0.3),dispay="image")
sm.regression(x2,y,h=c(0.3),dispay="image")
sm.regression(c(x1,x2),y,h=c(0.3,0.3),dispay="image")
sm.regression(x1,x2,y,h=c(0.3,0.3),dispay="image")
cbind(x1,x2)
sm.regression(cbind(x1,x2),y,h=c(0.3,0.3))
library(np)
install.packages("np")
library(np)
library(np)
library(np)
install.packages("np")
library(np)
npregbw(y~x1+x2,regtype="ll")
z3=npregbw(y~x1+x2,regtype="ll")
mod3=npregbw(y~x1+x2,regtype="ll")
z3=expand.grid(x1,x2)
persp(x1,x2,predict(mod3,z3),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
predict(mod3,z3)
mod3$terms
predict(mod3,z3)
library(sm)
install.packages("sm")
library(sm)
sm.regression(cbind(x1,x2),y)
sm.regression(cbind(x1,x2),y,theta=120)
sm.regression(cbind(x1,x2),y,theta=120,col="se")
sm.regression(cbind(x1,x2),y,theta=120,method="cv")
mod1=loess(y~x1+x2,degree = 0)
z1=expand.grid(x1,x2)
mod2=loess(y~x1+x2,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod1$
par(mfrow=c(1,3))
mod1$enp
mod1$s
mod1$trace.hat
mod1$y
View(z1)
sm.regression(cbind(x1,x2),y,h=c(0.3,0.3),theta=120,method="cv")
sm.regression(cbind(x1,x2),y,h=c(0.3,0.3),theta=120,dipay="image")
a=cbind(x1,x2)
sm.regression(a,y,h=c(0.3,0.3),theta=120,dipay="image")
y
a
sm.regression(x1,y,h=c(0.3,0.3),theta=120,dipay="image")
sm.regression(x1,x2,y,h=c(0.3,0.3),theta=120,dipay="image")
sm.regression(c(x1,x2),y,h=c(0.3,0.3),theta=120,dipay="image")
sm.regression(c(x1,x2),y,h=c(0.3,0.3),dipay="image")
sm.regression(cbind(x1,x2),y,h=c(0.3,0.3),dipay="image")
npregbw(y~x1+x2,regtype="ll")
mod3=npregbw(y~x1+x2,regtype="ll")
mod3$ydati
mod3$total.time
mod3$bw
mod3$regtype
mod3$pregtype
mod3$method
mod3$fval
mod3$ifval
mod3$fval.history
mod3$scaling
mod3$pscaling
mod3$type
mod3$ptype
mod3$nobs
mod3$ncon
mod3$xmcv
mod3$terms
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.01)
x2=seq(0,1,0.01)
z=outer(x1,x2,m)
error=rnorm(51,0,1/4)
y=m(x1,x2)+error
mod1=loess(y~x1+x2,span=0.3,degree = 0)
z1=expand.grid(x1,x2)
mod2=loess(y~x1+x2,span=0.3,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.02)
x2=seq(0,1,0.02)
z=outer(x1,x2,m)
error=rnorm(51,0,1/4)
y=m(x1,x2)+error
mod1=loess(y~x1+x2,span=0.3,degree = 0)
z1=expand.grid(x1,x2)
mod2=loess(y~x1+x2,span=0.3,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod3=loess(y~x1+x2,degree = 0)
z3=expand.grid(x1,x2)
mod4=loess(y~x1+x2,degree = 1)
z4=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x3,x4,z,phi=30,col = "green",main="Función",ticktype = "detailed")
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod3,z3),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod4,z4),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod2$enp
mod2$s
mod2$trace.hat
mod2$fitted
mod2$
mod4=loess(y~x1+x2,degree = 1)
mod2$s
mod3$s
mod2=loess(y~x1+x2,span=0.15,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod2=loess(y~x1+x2,span=0.5,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod2=loess(y~x1+x2,span=0.8,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod2=loess(y~x1+x2,span=0.6,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod2=loess(y~x1+x2,span=0.7,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod3=loess(y~x1+x2,degree = 0)
z3=expand.grid(x1,x2)
mod3$s
mod4=loess(y~x1+x2,degree = 1)
z4=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod3,z3),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod4,z4),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
mod1=loess(y~x1+x2,span=0.3,degree = 0)
z1=expand.grid(x1,x2)
mod2=loess(y~x1+x2,span=0.3,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.02)
x2=seq(0,1,0.02)
z=outer(x1,x2,m)
error=rnorm(51,0,1/4)
y=m(x1,x2)+error
mod1=loess(y~x1+x2,span=0.3,degree = 0)
x1=seq(0,1,0.001)
x1=seq(0,1,0.002)
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.002)
x2=seq(0,1,0.002)
z=outer(x1,x2,m)
error=rnorm(501,0,1/4)
y=m(x1,x2)+error
mod1=loess(y~x1+x2,span=0.3,degree = 0)
z1=expand.grid(x1,x2)
mod2=loess(y~x1+x2,span=0.3,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.01)
x2=seq(0,1,0.01)
z=outer(x1,x2,m)
error=rnorm(51,0,1/4)
y=m(x1,x2)+error
set.seed(01012022)
m=function(x1,x2) sin(2*pi*x1)+x2
x1=seq(0,1,0.01)
x2=seq(0,1,0.01)
z=outer(x1,x2,m)
error=rnorm(101,0,1/4)
y=m(x1,x2)+error
# Con lambda igual a 0.3
mod1=loess(y~x1+x2,span=0.3,degree = 0)
z1=expand.grid(x1,x2)
mod2=loess(y~x1+x2,span=0.3,degree = 1)
z2=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local",ticktype = "detailed")
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod1,z1),phi=30,col = "green",main="Nadaraya Watson-lambda=0.3",ticktype = "detailed")
persp(x1,x2,predict(mod2,z2),phi=30,col = "green",main="Lineal local-lambda=0.3",ticktype = "detailed")
# Sin lambda dado
mod3=loess(y~x1+x2,degree = 0)
z3=expand.grid(x1,x2)
mod4=loess(y~x1+x2,degree = 1)
z4=expand.grid(x1,x2)
par(mfrow=c(1,3))
persp(x1,x2,z,phi=30,col = "green",main="Función",ticktype = "detailed")
persp(x1,x2,predict(mod3,z3),phi=30,col = "green",main="Nadaraya Watson-lambda=automatico",ticktype = "detailed")
persp(x1,x2,predict(mod4,z4),phi=30,col = "green",main="Lineal local-lambda=automatico",ticktype = "detailed")
